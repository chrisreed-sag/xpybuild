
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>xpybuild.targets.custom &#8212; xpybuild 3.0.dev2 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="xpybuild.propertysupport" href="xpybuild.propertysupport.html" />
    <link rel="prev" title="xpybuild.targets.copy" href="xpybuild.targets.copy.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="xpybuild.propertysupport.html" title="xpybuild.propertysupport"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="xpybuild.targets.copy.html" title="xpybuild.targets.copy"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">xpybuild 3.0.dev2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" accesskey="U">Module list</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-xpybuild.targets.custom">
<span id="xpybuild-targets-custom"></span><h1>xpybuild.targets.custom<a class="headerlink" href="#module-xpybuild.targets.custom" title="Permalink to this headline">¶</a></h1>
<div class="section" id="custom">
<h2>Custom<a class="headerlink" href="#custom" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="xpybuild.targets.custom.Custom">
<em class="property">class </em><code class="sig-prename descclassname">xpybuild.targets.custom.</code><code class="sig-name descname">Custom</code><span class="sig-paren">(</span><em class="sig-param">target</em>, <em class="sig-param">deps</em>, <em class="sig-param">fn</em>, <em class="sig-param">cleanfn=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xpybuild/targets/custom.html#Custom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xpybuild.targets.custom.Custom" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="xpybuild.basetarget.html#xpybuild.basetarget.BaseTarget" title="xpybuild.basetarget.BaseTarget"><code class="xref py py-class docutils literal notranslate"><span class="pre">xpybuild.basetarget.BaseTarget</span></code></a></p>
<p>DEPRECATED - use CustomCommand instead, or a dedicated BaseTarget subclass</p>
<p>A custom target that builds a single file or directory of content by executing 
an arbitrary python functor.</p>
<p>Functor must take:
(target path, [dependency paths], context)</p>
<p>Tip: don’t forget to ensure the target path’s parent dir exists 
using fileutils.mkdir.</p>
<dl class="field-list simple">
<dt class="field-odd">Deprecated</dt>
<dd class="field-odd"><p>Use CustomCommand instead, or a dedicated BaseTarget subclass</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>target</strong> – The target file/directory that will be built</p></li>
<li><p><strong>deps</strong> – The list of dependencies of this target (paths, pathsets or lists)</p></li>
<li><p><strong>fn</strong> – The functor used to build this target</p></li>
<li><p><strong>cleanfn</strong> – The functor used to clean this target (optional, defaults to removing 
the target file/dir)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="customcommand">
<h2>CustomCommand<a class="headerlink" href="#customcommand" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="xpybuild.targets.custom.CustomCommand">
<em class="property">class </em><code class="sig-prename descclassname">xpybuild.targets.custom.</code><code class="sig-name descname">CustomCommand</code><span class="sig-paren">(</span><em class="sig-param">target</em>, <em class="sig-param">command</em>, <em class="sig-param">dependencies</em>, <em class="sig-param">cwd=None</em>, <em class="sig-param">redirectStdOutToTarget=False</em>, <em class="sig-param">env=None</em>, <em class="sig-param">stdout=None</em>, <em class="sig-param">stderr=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xpybuild/targets/custom.html#CustomCommand"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xpybuild.targets.custom.CustomCommand" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="xpybuild.basetarget.html#xpybuild.basetarget.BaseTarget" title="xpybuild.basetarget.BaseTarget"><code class="xref py py-class docutils literal notranslate"><span class="pre">xpybuild.basetarget.BaseTarget</span></code></a></p>
<p>A custom target that builds a single file or directory of content by running a 
specified command line process.</p>
<p>The command line MUST not reference any generated paths unless they are 
explicitly listed in deps.</p>
<p>Supported target options include:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.option(&quot;process.timeout&quot;)</span></code> to control the maximum number of seconds the command can 
run before being cancelled.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.option(&quot;common.processOutputEncodingDecider&quot;)</span></code> to determine the encoding 
used for reading stdout/err (see <a class="reference internal" href="xpybuild.utils.process.html#xpybuild.utils.process.defaultProcessOutputEncodingDecider" title="xpybuild.utils.process.defaultProcessOutputEncodingDecider"><code class="xref py py-obj docutils literal notranslate"><span class="pre">xpybuild.utils.process.defaultProcessOutputEncodingDecider</span></code></a>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.option(&quot;CustomCommand.outputHandlerFactory&quot;)</span></code> to replace the default behaviour 
for detecting errors (which is just based on zero/non-zero exit code) and logging stdout/err with 
a custom <a class="reference internal" href="xpybuild.utils.outputhandler.html#xpybuild.utils.outputhandler.ProcessOutputHandler" title="xpybuild.utils.outputhandler.ProcessOutputHandler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">xpybuild.utils.outputhandler.ProcessOutputHandler</span></code></a>. The additional 
options described on <code class="xref py py-obj docutils literal notranslate"><span class="pre">ProcessOutputHandler</span></code> can also be used with this target.</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> – the file or directory to be built. Will be cleaned, and its parent dir created, 
before target runs.</p></li>
<li><p><strong>dependencies</strong> – an optional list of dependencies; it is essential that ALL dependencies required by 
this command and generated by the build processare explicitly listed here, in addition to any 
files/directories used by this command that might change between builds.</p></li>
<li><p><strong>command</strong> – <p>a function or a list. 
If command is a list, items may be:</p>
<blockquote>
<div><ul>
<li><dl class="simple">
<dt>a string (which will be run through expandPropertyValues prior to execution); </dt><dd><p>must not be used for representing arguments that are paths</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>a PathSet (which must resolve to exactly one path - see joinPaths </dt><dd><p>property functor if multiple paths are required). Any PathSets used in 
the arguments should usually be explicitly listed in dependencies too, 
especially if they are generated by another part of this build.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>a property functor such as joinPaths (useful for constructing </dt><dd><p>Java classpaths), basename, etc</p>
</dd>
</dl>
</li>
<li><p>an arbitrary function taking a single context argument</p></li>
<li><p>CustomCommand.TARGET - a special value that is resolved to the</p></li>
</ul>
<p>output path of this target
- CustomCommand.DEPENDENCIES - a special value that is resolved to 
a list of this target’s dependencies
- [deprecated] a ResolvePath(path) object, indicating a path that should be</p>
<blockquote>
<div><p>resolved and resolved at execution time (this is equivalent 
to using a PathSet, which is probably a better approach).</p>
</div></blockquote>
</div></blockquote>
</p></li>
</ul>
</dd>
</dl>
<p>If command is a function, must have 
signature (resolvedTargetDirPath, resolvedDepsList, context), and 
return the command line as a list of strings. resolvedDepsList will be an 
ordered, flattened list of resolved paths from deps.</p>
<p>Command lines MUST NOT depend 
in any way on the current source or output directory, always use 
a PathSet wrapper around such paths.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cwd</strong> – the working directory to run it from (almost always this should be 
left blank, meaning use output dir)</p></li>
<li><p><strong>env</strong> – a dictionary of environment overrides, or a function that 
returns one given a context. Values in the dictionary will 
be expanded using the same rules as for the command (see above). 
Consider using <a class="reference internal" href="xpybuild.propertysupport.html#xpybuild.propertysupport.joinPaths" title="xpybuild.propertysupport.joinPaths"><code class="xref py py-obj docutils literal notranslate"><span class="pre">xpybuild.propertysupport.joinPaths</span></code></a> for environment variables 
containing a list of paths.</p></li>
<li><p><strong>redirectStdOutToTarget</strong> – usually, any stdout is treated as logging 
and the command is assumed to create the target file itself, but 
set this to True for commands where the target file contents are 
generated by the stdout of the command being executed.</p></li>
<li><p><strong>stdout</strong> – usually a unique name is auto-generated for .out for this target, but 
use this if required to send output to a specific location.</p></li>
<li><p><strong>stderr</strong> – usually a unique name is auto-generated for .err for this target, but 
use this if required to send output to a specific location.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="customcommandwithcopy">
<h2>CustomCommandWithCopy<a class="headerlink" href="#customcommandwithcopy" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="xpybuild.targets.custom.CustomCommandWithCopy">
<em class="property">class </em><code class="sig-prename descclassname">xpybuild.targets.custom.</code><code class="sig-name descname">CustomCommandWithCopy</code><span class="sig-paren">(</span><em class="sig-param">target</em>, <em class="sig-param">command</em>, <em class="sig-param">dependencies</em>, <em class="sig-param">copySrc</em>, <em class="sig-param">cwd=None</em>, <em class="sig-param">redirectStdOutToTarget=False</em>, <em class="sig-param">env=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xpybuild/targets/custom.html#CustomCommandWithCopy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xpybuild.targets.custom.CustomCommandWithCopy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#xpybuild.targets.custom.CustomCommand" title="xpybuild.targets.custom.CustomCommand"><code class="xref py py-class docutils literal notranslate"><span class="pre">xpybuild.targets.custom.CustomCommand</span></code></a>, <a class="reference internal" href="xpybuild.targets.copy.html#xpybuild.targets.copy.Copy" title="xpybuild.targets.copy.Copy"><code class="xref py py-class docutils literal notranslate"><span class="pre">xpybuild.targets.copy.Copy</span></code></a></p>
<p>A custom target that builds a directory of content by running a 
specified command line process, but unlike the normal CustomCommand 
also copies one or more files into the output directory before running the 
specified command.</p>
<p>For advanced cases only - usually it’s best to find a way to explicitly 
separate the target input and output and use a normal CustomCommand - but 
this target exists for badly written tools that are only able to do 
in-place modifications on a directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> – the target</p></li>
<li><p><strong>command</strong> – see CustomCommand for details</p></li>
<li><p><strong>dependencies</strong> – an explicit list of any dependencies (other than copySrc) 
that are required by the command, including static resources and 
other targets generated by the build. This is ESSENTIAL for 
reliable building.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="resolvepath">
<h2>ResolvePath<a class="headerlink" href="#resolvepath" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="xpybuild.targets.custom.ResolvePath">
<em class="property">class </em><code class="sig-prename descclassname">xpybuild.targets.custom.</code><code class="sig-name descname">ResolvePath</code><span class="sig-paren">(</span><em class="sig-param">path</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xpybuild/targets/custom.html#ResolvePath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xpybuild.targets.custom.ResolvePath" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>DEPRECATED: A wrapper around a string in a command line that indicates it is 
a path an should be resolved (expanded, normalized, possibly made relative 
to the target dir) when the command is executed.</p>
<p>If the specified path resolves to more than one item then an exception is 
thrown unless the pathsep argument is specified.</p>
<dl class="field-list simple">
<dt class="field-odd">Deprecated</dt>
<dd class="field-odd"><p>Use a PathSet (possibly with the joinPaths property functor) 
instead of this class.</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><p><strong>path</strong> – The path to expand, which is a string.</p>
</dd>
</dl>
<dl class="method">
<dt id="xpybuild.targets.custom.ResolvePath.resolve">
<code class="sig-name descname">resolve</code><span class="sig-paren">(</span><em class="sig-param">context</em>, <em class="sig-param">baseDir</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/xpybuild/targets/custom.html#ResolvePath.resolve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#xpybuild.targets.custom.ResolvePath.resolve" title="Permalink to this definition">¶</a></dt>
<dd><p>Resolves the path using the specified context and baseDir</p>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">xpybuild.targets.custom</a><ul>
<li><a class="reference internal" href="#custom">Custom</a></li>
<li><a class="reference internal" href="#customcommand">CustomCommand</a></li>
<li><a class="reference internal" href="#customcommandwithcopy">CustomCommandWithCopy</a></li>
<li><a class="reference internal" href="#resolvepath">ResolvePath</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="xpybuild.targets.copy.html"
                        title="previous chapter">xpybuild.targets.copy</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="xpybuild.propertysupport.html"
                        title="next chapter">xpybuild.propertysupport</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/generated/xpybuild.targets.custom.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="xpybuild.propertysupport.html" title="xpybuild.propertysupport"
             >next</a> |</li>
        <li class="right" >
          <a href="xpybuild.targets.copy.html" title="xpybuild.targets.copy"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">xpybuild 3.0.dev2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" >Module list</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Ben Spiller and Matthew Johnson.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.0.
    </div>
  </body>
</html>